import{a as _}from"/build/_shared/chunk-K3LLJEF6.js";import{a as C,b as h}from"/build/_shared/chunk-BVJBT3X3.js";import{d as u}from"/build/_shared/chunk-T36URGAI.js";var t=u(C(),1);var e=u(h(),1),L=(0,t.lazy)(()=>import("/build/_shared/ProjectSummary-O6J6GUKV.js")),$=(0,t.lazy)(()=>import("/build/_shared/Invoiced-A63EN7RZ.js")),F=(0,t.lazy)(()=>import("/build/_shared/ActionItems-E4YVQDCS.js")),R=(0,t.lazy)(()=>import("/build/_shared/SummaryPercentages-LDEBNWTZ.js")),O=(0,t.lazy)(()=>import("/build/_shared/WorkInprogress-HIIY3F3J.js")),z=(0,t.lazy)(()=>import("/build/_shared/RecentPhtotos-RGPZYIYN.js")),A=(0,t.lazy)(()=>import("/build/_shared/Schedular-FWN7NMUL.js")),E=(0,t.lazy)(()=>import("/build/_shared/Top-4F6IOXKS.js")),M=()=>[{title:"Project Dashboard"},{name:"description",content:"Project management dashboard"}];function b({projectId:r,userId:s,compId:c}){let[n,P]=(0,t.useState)(null),[w,m]=(0,t.useState)(!0),[g,f]=(0,t.useState)(null),[o,v]=(0,t.useState)(r),[d,S]=(0,t.useState)(s),[p,j]=(0,t.useState)(c);console.log("currentProjectID =======>>>>>>>>",JSON.parse(typeof window<"u"&&window.localStorage.getItem("currProject"))!==o),console.log("projectID =======>>>>>>>>",o),console.log("userId =======>>>>>>>>",d),console.log("COMPiD =======>>>>>>>>",p);let y=(0,t.useCallback)(async()=>{try{m(!0),f(null),console.log("Fetching data...");let a=new FormData;a.append("op","get_project_detail"),a.append("project_id",o.toString()),a.append("is_refresh","0"),a.append("record_type","project"),a.append("version","web"),a.append("from","panel"),a.append("iframe_call","0"),a.append("tz","+5:30"),a.append("tzid","Asia/Calcutta"),a.append("curr_time",new Date().toISOString()),a.append("force_login","0"),a.append("global_project",""),a.append("user_id",d),a.append("company_id",p);let l=await _.post(`https://api-cfdev.contractorforeman.net/service.php?opp=get_project_detail&c=${p}&u=${d}&p=manage_projects`,a);console.log("Data fetched successfully",l?.data);let D=l?.data?.data;P(D)}catch(a){console.error("Error fetching data:",a),f("Failed to load data. Please try again.")}finally{m(!1)}},[o,d,p]);if((0,t.useEffect)(()=>{let a=JSON.parse(typeof window<"u"&&window.localStorage.getItem("currProject"));!n||(!n||a!==o||r!==o||s!==d||c!==p)||o?(console.log("Props changed, fetching new data"),y(),v(r),S(s),j(c)):console.log("No prop changes, skipping data fetch")},[o,s,c]),w)return(0,e.jsx)("div",{className:"flex justify-center items-center h-screen",children:"Loading..."});if(g)return(0,e.jsxs)("div",{className:"flex flex-col justify-center items-center h-screen",children:[(0,e.jsx)("p",{children:g}),(0,e.jsx)("button",{onClick:y,className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded",children:"Retry"})]});if(!n)return(0,e.jsx)("div",{className:"flex justify-center items-center h-screen",children:"No data available"});let{project_summary:x,wip_widget:N,customer_additional_contacts:I,billing_vs_actual:k}=n,i="bg-white border rounded-md hover:shadow-lg transition-shadow duration-500";return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"space-y-4 p-4 overflow-y-auto sidebar",children:[(0,e.jsx)("div",{className:"space-x-4",children:["137238","138634","147428","137389"].map(a=>(0,e.jsx)("button",{className:"",onClick:()=>v(a),children:a},a))}),(0,e.jsx)("div",{className:"w-full",children:(0,e.jsx)(t.Suspense,{fallback:(0,e.jsx)("p",{children:"Loading Project topbar..."}),children:(0,e.jsx)(E,{data:k})})}),(0,e.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-3",children:[(0,e.jsx)("div",{className:`${i} p-4`,children:(0,e.jsx)(t.Suspense,{fallback:(0,e.jsx)("p",{children:"Loading Project Summary..."}),children:(0,e.jsx)(L,{data:x})})}),(0,e.jsx)("div",{className:`${i} px-4 pt-4`,children:(0,e.jsx)(t.Suspense,{fallback:(0,e.jsx)("p",{children:"Loading Summary Percentages..."}),children:(0,e.jsx)(R,{data:n})})}),(0,e.jsx)("div",{className:`${i} px-4 pt-4`,children:(0,e.jsx)(t.Suspense,{fallback:(0,e.jsx)("p",{children:"Loading Action Items..."}),children:(0,e.jsx)(F,{projectId:r,userId:s,compId:c})})}),(0,e.jsx)("div",{children:(0,e.jsx)(t.Suspense,{fallback:(0,e.jsx)("p",{children:"Loading Invoiced..."}),children:(0,e.jsx)($,{data:n,customer_additional_contacts:I})})}),(0,e.jsx)("div",{className:`${i} px-4 pb-2 lg:pt-4`,children:(0,e.jsx)(t.Suspense,{fallback:(0,e.jsx)("p",{children:"Loading Work In Progress..."}),children:(0,e.jsx)(O,{data:N})})}),(0,e.jsx)("div",{className:`${i} p-4`,children:(0,e.jsx)(t.Suspense,{fallback:(0,e.jsx)("p",{children:"Loading Recent Photos..."}),children:(0,e.jsx)(z,{data:n})})})]}),(0,e.jsx)("div",{className:`${i} px-4 h-60`,children:(0,e.jsx)(t.Suspense,{fallback:(0,e.jsx)("p",{children:"Loading Scheduler..."}),children:(0,e.jsx)(A,{projectId:r,userId:s,compId:c})})})]},r)})}export{b as default,M as meta};
