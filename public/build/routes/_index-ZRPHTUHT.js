import{a as y}from"/build/_shared/chunk-K3LLJEF6.js";import{a as L,b as h}from"/build/_shared/chunk-BVJBT3X3.js";import{d as m}from"/build/_shared/chunk-T36URGAI.js";var t=m(L(),1);var e=m(h(),1),I=(0,t.lazy)(()=>import("/build/_shared/ProjectSummary-O6J6GUKV.js")),$=(0,t.lazy)(()=>import("/build/_shared/Invoiced-A63EN7RZ.js")),F=(0,t.lazy)(()=>import("/build/_shared/ActionItems-E4YVQDCS.js")),R=(0,t.lazy)(()=>import("/build/_shared/SummaryPercentages-LDEBNWTZ.js")),z=(0,t.lazy)(()=>import("/build/_shared/WorkInprogress-HIIY3F3J.js")),A=(0,t.lazy)(()=>import("/build/_shared/RecentPhtotos-RGPZYIYN.js")),E=(0,t.lazy)(()=>import("/build/_shared/Schedular-M6S7MIKZ.js")),M=(0,t.lazy)(()=>import("/build/_shared/Top-4F6IOXKS.js")),O=()=>[{title:"Project Dashboard"},{name:"description",content:"Project management dashboard"}];function _({projectId:o,userId:n,compId:s}){let[r,b]=(0,t.useState)(null),[P,u]=(0,t.useState)(!0),[g,f]=(0,t.useState)(null),[d,S]=(0,t.useState)(o),[i,x]=(0,t.useState)(n),[p,N]=(0,t.useState)(s);console.log("projectID =======>>>>>>>>",d),console.log("userId =======>>>>>>>>",i),console.log("COMPiD =======>>>>>>>>",p);let l=(0,t.useCallback)(async()=>{try{u(!0),f(null),console.log("Fetching data...");let a=new FormData;a.append("op","get_project_detail"),a.append("project_id",d.toString()),a.append("is_refresh","0"),a.append("record_type","project"),a.append("version","web"),a.append("from","panel"),a.append("iframe_call","0"),a.append("tz","+5:30"),a.append("tzid","Asia/Calcutta"),a.append("curr_time",new Date().toISOString()),a.append("force_login","0"),a.append("global_project",""),a.append("user_id",i),a.append("company_id",p);let v=await y.post(`https://api-cfdev.contractorforeman.net/service.php?opp=get_project_detail&c=${Number(p)??0}&u=${Number(i)??0}&p=manage_projects`,a);console.log("Data fetched successfully",v?.data);let C=v?.data?.data;b(C)}catch(a){console.error("Error fetching data:",a),f("Failed to load data. Please try again.")}finally{u(!1)}},[d,p,i,o,n,s]);if((0,t.useEffect)(()=>{l(),console.log(!r||o!==d||n!==i||s!==p),r?console.log("No prop changes, skipping data fetch"):(console.log("Props changed, fetching new data"),l(),S(o),x(n),N(s))},[o,n,s]),P)return(0,e.jsx)("div",{className:"flex justify-center items-center h-screen",children:"Loading..."});if(g)return(0,e.jsxs)("div",{className:"flex flex-col justify-center items-center h-screen",children:[(0,e.jsx)("p",{children:g}),(0,e.jsx)("button",{onClick:l,className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded",children:"Retry"})]});if(!r)return(0,e.jsx)("div",{className:"flex justify-center items-center h-screen",children:"No data available"});let{project_summary:j,wip_widget:w,customer_additional_contacts:k,billing_vs_actual:D}=r,c="bg-white border rounded-md hover:shadow-lg transition-shadow duration-500";return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"space-y-4 p-4 overflow-y-auto sidebar",children:[(0,e.jsx)("div",{className:"w-full",children:(0,e.jsx)(t.Suspense,{fallback:(0,e.jsx)("p",{children:"Loading Project topbar..."}),children:(0,e.jsx)(M,{data:D})})}),(0,e.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-3",children:[(0,e.jsx)("div",{className:`${c} p-4`,children:(0,e.jsx)(t.Suspense,{fallback:(0,e.jsx)("p",{children:"Loading Project Summary..."}),children:(0,e.jsx)(I,{data:j})})}),(0,e.jsx)("div",{className:`${c} px-4 pt-4`,children:(0,e.jsx)(t.Suspense,{fallback:(0,e.jsx)("p",{children:"Loading Summary Percentages..."}),children:(0,e.jsx)(R,{data:r})})}),(0,e.jsx)("div",{className:`${c} px-4 pt-4`,children:(0,e.jsx)(t.Suspense,{fallback:(0,e.jsx)("p",{children:"Loading Action Items..."}),children:(0,e.jsx)(F,{projectId:o,userId:n,compId:s})})}),(0,e.jsx)("div",{children:(0,e.jsx)(t.Suspense,{fallback:(0,e.jsx)("p",{children:"Loading Invoiced..."}),children:(0,e.jsx)($,{data:r,customer_additional_contacts:k})})}),(0,e.jsx)("div",{className:`${c} px-4 pb-2 lg:pt-4`,children:(0,e.jsx)(t.Suspense,{fallback:(0,e.jsx)("p",{children:"Loading Work In Progress..."}),children:(0,e.jsx)(z,{data:w})})}),(0,e.jsx)("div",{className:`${c} p-4`,children:(0,e.jsx)(t.Suspense,{fallback:(0,e.jsx)("p",{children:"Loading Recent Photos..."}),children:(0,e.jsx)(A,{data:r})})})]}),(0,e.jsx)("div",{className:`${c} px-4 h-60`,children:(0,e.jsx)(t.Suspense,{fallback:(0,e.jsx)("p",{children:"Loading Scheduler..."}),children:(0,e.jsx)(E,{projectId:o,userId:n,compId:s})})})]},o)})}export{_ as default,O as meta};
